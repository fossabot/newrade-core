{"version":3,"sources":["../../src/commands/figma-sync.ts"],"sourcesContent":["import path from 'path';\n\nimport { Command, Flags } from '@oclif/core';\nimport debug from 'debug';\nimport * as t from 'io-ts';\n\nimport { extract } from '@newrade/core-figma-extractor';\nimport { loadDotEnv } from '@newrade/core-node-utils';\n\nimport { NS } from '../utilities/log.utilities.js';\n\nexport type ENV = t.TypeOf<typeof Env>;\nexport const Env = t.intersection([\n  t.type({}),\n  t.type({\n    FIGMA_TOKEN: t.string,\n    FIGMA_FILE: t.string,\n  }),\n]);\n\nexport default class FigmaSync extends Command {\n  log = debug(`${NS}:figma-sync`);\n  logWarn = debug(`${NS}:figma-sync:warn`);\n  logError = debug(`${NS}:figma-sync:error`);\n\n  static description = 'sync design tokens from figma file';\n\n  static examples = [`$ nr figma-sync`];\n\n  static flags = {\n    test: Flags.boolean({\n      char: 't',\n      description:\n        'the test flag is used in integration tests, it will not output versions or dates',\n    }),\n    help: Flags.help({ char: 'h' }),\n  };\n\n  static args = [{ name: 'path', description: 'relative output path' }];\n\n  async init() {}\n\n  async run() {\n    const env = loadDotEnv<ENV>({\n      schema: Env,\n      dotEnvPath: '.env',\n      packageName: 'core-cli',\n    });\n\n    const { args, flags } = await this.parse(FigmaSync);\n\n    this.log(`running: extract command`);\n\n    await extract({\n      extractorName: '',\n      version: '',\n      figmaFile: env.FIGMA_FILE,\n      figmaToken: env.FIGMA_TOKEN,\n      outputDir: path.resolve(process.cwd(), args && args.path ? args.path : 'figma-export'),\n      inputColorThemeNamespace: false,\n      outputVersion: flags.test ? false : true,\n      outputDate: flags.test ? false : true,\n    });\n\n    this.log(`running: extract command`);\n  }\n}\n"],"names":["t","FigmaSync","Command","log","debug","NS","logWarn","logError","description","examples","flags","test","Flags","boolean","char","help","args","name","init","run","env","loadDotEnv","schema","Env","dotEnvPath","packageName","parse","extract","extractorName","version","figmaFile","FIGMA_FILE","figmaToken","FIGMA_TOKEN","outputDir","path","resolve","process","cwd","inputColorThemeNamespace","outputVersion","outputDate","intersection","type","string"],"mappings":"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"}